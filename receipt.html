<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title></title> <!-- Placeholder title -->
	<link rel="stylesheet" href="css/style.css">
	<!-- Datatable -->
	<link href="vendor/datatables/css/jquery.dataTables.min.css" rel="stylesheet">
	<!-- Custom Stylesheet -->
	<link href="vendor/bootstrap-select/dist/css/bootstrap-select.min.css" rel="stylesheet">
	<link href="vendor/datatables/responsive/responsive.css" rel="stylesheet">
	<link rel="stylesheet"
		href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@48,400,0,0">
	<link class="main-css" href="css/style.css" rel="stylesheet">
	<!-- html2canvas -->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

	<!-- jsPDF -->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
	<!-- <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script> -->
	<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

</head>
<style>
	.bg-receipt img {
		width: 100%;
		/* Makes the image take the full width of the container */
		height: 200px;
		/* Ensures the aspect ratio is maintained */
		object-fit: cover;
		/* Optional, ensures the image fills the container */
	}


	.overlay {
		position: fixed;
		top: 0;
		left: 0;
		width: 100%;
		height: 100%;
		background: rgba(255, 255, 255, 0.8);
		display: flex;
		justify-content: center;
		align-items: center;
		z-index: 9999;
	}

	.spinner-border {
		width: 3rem;
		height: 3rem;
		border-width: 0.3em;
	}

	.table-striped tbody tr:nth-child(n+2) {
		background-color: #f9f9f9;
		/* Apply striped background to rows after the first */
	}
</style>

<script src="config.js"></script>

<body>

	<!-- Header Container -->
	<header id="header-container"></header>
	<!--*******************
        Preloader start
    ********************-->
	<div id="preloader" class="overlay">
		<div class="lds-ripple">
			<div></div>
			<div></div>
		</div>
	</div>
	<!--*******************
        Preloader end
    ********************-->
	<script type="module">
		import { createHeader } from './components/header.js';
		import { createMenu } from './components/menu.js';
		import { createHeaderNavbar } from './components/headerNavbar.js';
		// import { createWalletOverlay } from './components/wallet-overlay.js';
		import { createNavHeader } from './components/nav-header.js';

		function getQueryParam(name) {
			const urlParams = new URLSearchParams(window.location.search);
			return urlParams.get(name);
		}

		// Get the booking ID from the query parameters
		const bookingId = getQueryParam("bookingId");

		let allPackages = [];

		document.addEventListener('DOMContentLoaded', async function () {
			document.getElementById("preloader").style.display = "flex";
			const preloader = document.getElementById("preloader"); // Loader element (optional)
			console.log("preloader");
			console.log(preloader);

			const authToken = sessionStorage.getItem("authToken");
			const currentId = sessionStorage.getItem("currentUserId");

			const systemNameElement = document.querySelector('.system-name'); // Target the correct class
			if (systemNameElement) {
				systemNameElement.textContent = CONFIG.SYSTEM_NAME;
			}


			try {

				if (!authToken) {
					// Redirect to login page if token is not found or expired
					window.location.href = "login.html";
				} else {
					fetchUserInfo(authToken, currentId);
					fetchBookingById(authToken, currentId, bookingId);
					fetchPackagesByAdminId(authToken, currentId);
					console.log(authToken);
				}

				const pageName = "Receipt";

				document.querySelectorAll(".page-name").forEach((el) => {
					el.textContent = pageName;
				});
				// Parallelize async functions to reduce wait time
				await Promise.all([
					await createHeader(pageName, CONFIG.SYSTEM_NAME),
					await createMenu(),
					await createHeaderNavbar(pageName),
					// await createWalletOverlay(),
					await createNavHeader(),
				]);
			} catch (error) {
				Swal.fire({
					title: "Error",
					text: "Network error, try again",
					icon: "error",
					confirmButtonText: "Okay",
				});
				location.reload();
			}
		});

		async function fetchPackagesByAdminId(authToken, currentId) {
			const preloader = document.getElementById('preloader');
			const packageSelect = document.getElementById('packageSelect');

			try {
				let response = await fetch(`${CONFIG.API_URL}?action=packages_by_admin_id&token=${authToken}&admin_id=${currentId}`);
				let data = await response.json();

				console.log(data);
				if (data.success) {

					allPackages = data.data || [];
					console.log("allPackages");
					console.log(allPackages);
					sessionStorage.setItem('allPackages', JSON.stringify(allPackages));
					// packageSelect.innerHTML = '<option value="">Select Package</option>';

					// const packages = data.data || [];

					// console.log(packages);
					// packages.forEach(pkg => {
					//     const option = document.createElement('option');
					//     option.value = pkg.id;
					//     option.textContent = pkg.package_name;
					//     option.setAttribute('data-price', pkg.price);
					//     packageSelect.appendChild(option);
					// });

				} else {
					Swal.fire({
						title: "Error",
						text: "Session end, please try again",
						icon: "error",
						confirmButtonText: "Okay",
					});
					// alert(data.message);
					// location.reload();

				}
			} catch (error) {
				Swal.fire({
					title: "Error",
					text: "Network error, please try again",
					icon: "error",
					confirmButtonText: "Okay",
				});
				// location.reload();
			} finally {
				if (preloader) {
					preloader.style.display = "none";
				}

			}
		}

		async function fetchUserInfo(authToken, currentId) {
			const preloader = document.getElementById('preloader');

			try {
				let response = await fetch(`${CONFIG.API_URL}?action=user_info&token=${authToken}&id=${currentId}`);
				let data = await response.json();

				console.log(data);
				if (data.success) {
					document.querySelectorAll(".userName").forEach((el) => {
						el.textContent = data.user.name;
					});
					document.querySelectorAll(".userEmail").forEach((el) => {
						el.textContent = data.user.email;
					});

					document.getElementById("from-company-name").textContent = data.user.company_name;
					document.getElementById("from-address").textContent = data.user.state; // Modify if address structure changes
					document.getElementById("from-email").textContent = data.user.email;
					document.getElementById("from-phone").textContent = data.user.phone;

					// Update the social media info
					document.getElementById('whatsapp').textContent = data.user.whatsapp || '-';
					document.getElementById('tiktok').textContent = data.user.tiktok || '-';
					document.getElementById('instagram').textContent = data.user.instagram || '-';
					document.getElementById('facebook').textContent = data.user.facebook || '-';

					// Hide the entire container if no social media handle exists
					if (!data.user.whatsapp) {
						document.getElementById('whatsapp-container').style.setProperty('display', 'none', 'important');
					}
					if (!data.user.tiktok) {
						document.getElementById('tiktok-container').style.setProperty('display', 'none', 'important');
					}
					if (!data.user.instagram) {
						document.getElementById('instagram-container').style.setProperty('display', 'none', 'important');
					}
					if (!data.user.facebook) {
						document.getElementById('facebook-container').style.setProperty('display', 'none', 'important');
					}

					sessionStorage.setItem("workTypeId", data.user.work_type);

				} else {
					Swal.fire({
						title: "Error",
						text: "Session end, please re-login",
						icon: "error",
						confirmButtonText: "Okay",
					});
					// alert(data.message);
					// localStorage.removeItem("authToken"); // Clear invalid token
					// window.location.href = "login.html"; // Redirect to login
				}
			} catch (error) {
				Swal.fire({
					title: "Error",
					text: "Network error, please re-login",
					icon: "error",
					confirmButtonText: "Okay",
				});
				// location.reload();
			} finally {
				if (preloader) {
					preloader.style.display = "none";
				}
			}
		}
		async function fetchBookingById(authToken, admin_id, bookingId) {
			const preloader = document.getElementById('preloader');
			const packageSelect = document.getElementById('packageSelect');

			try {
				let response = await fetch(`${CONFIG.API_URL}?action=booking_by_id&token=${authToken}&admin_id=${admin_id}&booking_id=${bookingId}`);
				let data = await response.json();

				if (data.success) {
					const booking = data.data[0];
					console.log(booking);
					const dateObj = new Date(booking.created_at);

					const formattedDate = dateObj.toLocaleDateString('en-GB', {
						day: '2-digit',
						month: 'long',
						year: 'numeric'
					});

					const serviceBg = document.getElementById("service-bg");

					if (booking.service_type === 1) {
						serviceBg.src = "images/wedding-bg.jpg"; // Set wedding background
					} else if (booking.service_type === 2) {
						serviceBg.src = "images/photographer-bg.jpg"; // Set photographer background
					}
					document.getElementById("to-name").textContent = booking.customer_name;
					document.getElementById("to-state").textContent = booking.state; // Modify if address structure changes
					document.getElementById("to-address").textContent = booking.address;
					document.getElementById("to-phone").textContent = booking.phone;
					document.getElementById("payment-method").textContent = booking.payment_method;

					document.getElementById("receipt-date").textContent = formattedDate; // You may need to format the date
					document.getElementById("receipt-status").textContent =
						booking.payment_type === 1 ? "Deposit" :
							booking.payment_type === 2 ? "Full payment" :
								"Unknown";

					const itemsContainer = document.getElementById("booking-items");
					const allPackages = JSON.parse(sessionStorage.getItem('allPackages'));

					// Check if the booking object has necessary properties
					if (booking) {
						const packageDetails = allPackages.find(pkg => pkg.id === booking.package_id);
						const itemList = packageDetails.item_list ? JSON.parse(packageDetails.item_list) : [];
						const dateObj = new Date(booking.date);
						const workType = CONFIG.WORK_TYPE[packageDetails.work_type];
						const packageType = workType ? workType.TYPE_PACKAGE[packageDetails.type] : '';
						const formattedDate = dateObj.toLocaleDateString('en-GB', {
							day: '2-digit',
							month: 'long',
							year: 'numeric'
						});

						if (!itemList || itemList.length === 0) {
							// Hide the Item column and header if no items exist
							document.getElementById('item-header').style.display = 'none';
							const rows = document.querySelectorAll('tbody tr');
							rows.forEach(row => {
								row.querySelector('td:nth-child(5)').style.display = 'none'; // Assuming the Item column is the 5th column
							});
						}

						function convertTo12HourFormat(timeStr) {
							if (!timeStr || typeof timeStr !== 'string') return '-';

							const [hourStr, minuteStr] = timeStr.split(':');
							const hour = parseInt(hourStr);
							const minute = parseInt(minuteStr);

							if (isNaN(hour) || isNaN(minute)) return '-';

							const ampm = hour >= 12 ? 'PM' : 'AM';
							const adjustedHour = hour % 12 || 12;

							return `${adjustedHour}:${minute.toString().padStart(2, '0')} ${ampm}`;
						}


						let row = document.createElement("tr");
						row.innerHTML = `
							<td class="center">1</td> <!-- You can hardcode the index if there's only one item -->
							<td class="left">
								Date: ${formattedDate}
								${booking.time ? `<br> Time: ${convertTo12HourFormat(booking.time)}` : ''}
							</td>
							<td class="left strong">${packageDetails.package_name ? packageDetails.package_name : 'Package not found'}</td>
							<td class="left strong">${packageType}</td>
							${itemList && itemList.length > 0 ? `
							<td id="item-header">
								<ul>
									${itemList.map(item => `<li>${item}</li>`).join('')}
								</ul>
							</td>` : ''}
							<td class="left strong">RM${booking.price ? booking.price : ''}</td>

						`;

						itemsContainer.appendChild(row);

					} else {
						// If no booking data is available
						let row = document.createElement("tr");
						row.innerHTML = `<td colspan="4" class="text-center">No booking details available</td>`;
						itemsContainer.appendChild(row);
					}


					// Populate totals in the receipt
					const totalsContainer = document.getElementById("receipt-totals");
					totalsContainer.innerHTML = `
						<tr>
							<td class="left"><strong>Subtotal</strong></td>
							<td class="right">RM${booking.price}</td>
						</tr>
						<tr>
							<td class="left">Discount</td>
							<td class="right">RM${booking.discount}</td>
						</tr>
						<tr>
							<td class="left"><strong>Total</strong></td>
							<td class="right"><strong>RM${booking.after_discount}</strong</td>
						</tr>
						<tr>
							<td class="left" ${booking.payment_type == 2 ? 'style="background-color: #e7e7e7; font-weight: 600;"' : ''}>${booking.payment_type == 2 ? '<strong>Amount Paid</strong>' : 'Amount Paid'}
							<td class="right" ${booking.payment_type == 2 ? 'style="background-color: #e7e7e7; font-weight: 600;"' : ''}>${booking.payment_type == 2 ? `<strong>RM${booking.paid_amount}</strong>` : `RM${booking.paid_amount}`}
						</tr>

						${booking.payment_type !== 2 ? `
						<tr>
							<td class="left" style="background-color: #e7e7e7;"><strong>Balance Due</strong></td>
							<td class="right" style="background-color: #e7e7e7;"><strong>RM${booking.balance}</strong></td>
						</tr>
						` : ''}
						
					`;

				} else {
					Swal.fire({
						title: "Error",
						text: "Session end, please try again",
						icon: "error",
						confirmButtonText: "Okay",
					});
					// alert(data.message);
					// location.reload();

				}
			} catch (error) {
				console.log(error);

				Swal.fire({
					title: "Error",
					text: "Invalid receipt no, please try again",
					icon: "error",
					confirmButtonText: "Okay",
				}).then(() => {
					// Redirect to the dashboard after the Swal confirmation
					// window.location.href = 'dashboard.html';
				});
			}
			finally {
				if (preloader) {
					preloader.style.display = "none";
				}

			}
		}
	</script>


	<!--**********************************
        Main wrapper start
    ***********************************-->
	<div id="main-wrapper">

		<!--**********************************
            Nav header start
        ***********************************-->
		<div id="nav-header" class="nav-header">

		</div>
		<!--**********************************
            Nav header end
        ***********************************-->

		<!--**********************************
            Chat box start
        ***********************************-->
		<div class="chatbox">
			<div class="chatbox-close"></div>
			<div class="custom-tab-1">
				<ul class="nav nav-tabs">
					<li class="nav-item">
						<a class="nav-link" data-bs-toggle="tab" href="#notes">Notes</a>
					</li>
					<li class="nav-item">
						<a class="nav-link" data-bs-toggle="tab" href="#alerts">Alerts</a>
					</li>
					<li class="nav-item">
						<a class="nav-link active" data-bs-toggle="tab" href="#chat">Chat</a>
					</li>
				</ul>
				<div class="tab-content">
					<div class="tab-pane fade active show" id="chat" role="tabpanel">
						<div class="card mb-sm-3 mb-md-0 contacts_card dlab-chat-user-box">
							<div class="card-header chat-list-header text-center">
								<a href="javascript:void(0);"><svg xmlns="http://www.w3.org/2000/svg"
										xmlns:xlink="http://www.w3.org/1999/xlink" width="18px" height="18px"
										viewBox="0 0 24 24" version="1.1">
										<g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
											<rect fill="#000000" x="4" y="11" width="16" height="2" rx="1" />
											<rect fill="#000000" opacity="0.3"
												transform="translate(12.000000, 12.000000) rotate(-270.000000) translate(-12.000000, -12.000000) "
												x="4" y="11" width="16" height="2" rx="1" />
										</g>
									</svg></a>
								<div>
									<h6 class="mb-1">Chat List</h6>
									<p class="mb-0">Show All</p>
								</div>
								<a href="javascript:void(0);"><svg xmlns="http://www.w3.org/2000/svg"
										xmlns:xlink="http://www.w3.org/1999/xlink" width="18px" height="18px"
										viewBox="0 0 24 24" version="1.1">
										<g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
											<rect x="0" y="0" width="24" height="24" />
											<circle fill="#000000" cx="5" cy="12" r="2" />
											<circle fill="#000000" cx="12" cy="12" r="2" />
											<circle fill="#000000" cx="19" cy="12" r="2" />
										</g>
									</svg></a>
							</div>
							<div class="card-body contacts_body p-0 dlab-scroll  " id="DLAB_W_Contacts_Body">
								<ul class="contacts">
									<li class="name-first-letter">A</li>
									<li class="active dlab-chat-user">
										<div class="d-flex bd-highlight">
											<div class="img_cont">
												<img src="images/avatar/1.jpg" class="rounded-circle user_img" alt="">
												<span class="online_icon"></span>
											</div>
											<div class="user_info">
												<span>Archie Parker</span>
												<p>Kalid is online</p>
											</div>
										</div>
									</li>
									<li class="dlab-chat-user">
										<div class="d-flex bd-highlight">
											<div class="img_cont">
												<img src="images/avatar/2.jpg" class="rounded-circle user_img" alt="">
												<span class="online_icon offline"></span>
											</div>
											<div class="user_info">
												<span>Alfie Mason</span>
												<p>Taherah left 7 mins ago</p>
											</div>
										</div>
									</li>
									<li class="dlab-chat-user">
										<div class="d-flex bd-highlight">
											<div class="img_cont">
												<img src="images/avatar/3.jpg" class="rounded-circle user_img" alt="">
												<span class="online_icon"></span>
											</div>
											<div class="user_info">
												<span>AharlieKane</span>
												<p>Sami is online</p>
											</div>
										</div>
									</li>
									<li class="dlab-chat-user">
										<div class="d-flex bd-highlight">
											<div class="img_cont">
												<img src="images/avatar/4.jpg" class="rounded-circle user_img" alt="">
												<span class="online_icon offline"></span>
											</div>
											<div class="user_info">
												<span>Athan Jacoby</span>
												<p>Nargis left 30 mins ago</p>
											</div>
										</div>
									</li>
									<li class="name-first-letter">B</li>
									<li class="dlab-chat-user">
										<div class="d-flex bd-highlight">
											<div class="img_cont">
												<img src="images/avatar/5.jpg" class="rounded-circle user_img" alt="">
												<span class="online_icon offline"></span>
											</div>
											<div class="user_info">
												<span>Bashid Samim</span>
												<p>Rashid left 50 mins ago</p>
											</div>
										</div>
									</li>
									<li class="dlab-chat-user">
										<div class="d-flex bd-highlight">
											<div class="img_cont">
												<img src="images/avatar/1.jpg" class="rounded-circle user_img" alt="">
												<span class="online_icon"></span>
											</div>
											<div class="user_info">
												<span>Breddie Ronan</span>
												<p>Kalid is online</p>
											</div>
										</div>
									</li>
									<li class="dlab-chat-user">
										<div class="d-flex bd-highlight">
											<div class="img_cont">
												<img src="images/avatar/2.jpg" class="rounded-circle user_img" alt="">
												<span class="online_icon offline"></span>
											</div>
											<div class="user_info">
												<span>Ceorge Carson</span>
												<p>Taherah left 7 mins ago</p>
											</div>
										</div>
									</li>
									<li class="name-first-letter">D</li>
									<li class="dlab-chat-user">
										<div class="d-flex bd-highlight">
											<div class="img_cont">
												<img src="images/avatar/3.jpg" class="rounded-circle user_img" alt="">
												<span class="online_icon"></span>
											</div>
											<div class="user_info">
												<span>Darry Parker</span>
												<p>Sami is online</p>
											</div>
										</div>
									</li>
									<li class="dlab-chat-user">
										<div class="d-flex bd-highlight">
											<div class="img_cont">
												<img src="images/avatar/4.jpg" class="rounded-circle user_img" alt="">
												<span class="online_icon offline"></span>
											</div>
											<div class="user_info">
												<span>Denry Hunter</span>
												<p>Nargis left 30 mins ago</p>
											</div>
										</div>
									</li>
									<li class="name-first-letter">J</li>
									<li class="dlab-chat-user">
										<div class="d-flex bd-highlight">
											<div class="img_cont">
												<img src="images/avatar/5.jpg" class="rounded-circle user_img" alt="">
												<span class="online_icon offline"></span>
											</div>
											<div class="user_info">
												<span>Jack Ronan</span>
												<p>Rashid left 50 mins ago</p>
											</div>
										</div>
									</li>
									<li class="dlab-chat-user">
										<div class="d-flex bd-highlight">
											<div class="img_cont">
												<img src="images/avatar/1.jpg" class="rounded-circle user_img" alt="">
												<span class="online_icon"></span>
											</div>
											<div class="user_info">
												<span>Jacob Tucker</span>
												<p>Kalid is online</p>
											</div>
										</div>
									</li>
									<li class="dlab-chat-user">
										<div class="d-flex bd-highlight">
											<div class="img_cont">
												<img src="images/avatar/2.jpg" class="rounded-circle user_img" alt="">
												<span class="online_icon offline"></span>
											</div>
											<div class="user_info">
												<span>James Logan</span>
												<p>Taherah left 7 mins ago</p>
											</div>
										</div>
									</li>
									<li class="dlab-chat-user">
										<div class="d-flex bd-highlight">
											<div class="img_cont">
												<img src="images/avatar/3.jpg" class="rounded-circle user_img" alt="">
												<span class="online_icon"></span>
											</div>
											<div class="user_info">
												<span>Joshua Weston</span>
												<p>Sami is online</p>
											</div>
										</div>
									</li>
									<li class="name-first-letter">O</li>
									<li class="dlab-chat-user">
										<div class="d-flex bd-highlight">
											<div class="img_cont">
												<img src="images/avatar/4.jpg" class="rounded-circle user_img" alt="">
												<span class="online_icon offline"></span>
											</div>
											<div class="user_info">
												<span>Oliver Acker</span>
												<p>Nargis left 30 mins ago</p>
											</div>
										</div>
									</li>
									<li class="dlab-chat-user">
										<div class="d-flex bd-highlight">
											<div class="img_cont">
												<img src="images/avatar/5.jpg" class="rounded-circle user_img" alt="">
												<span class="online_icon offline"></span>
											</div>
											<div class="user_info">
												<span>Oscar Weston</span>
												<p>Rashid left 50 mins ago</p>
											</div>
										</div>
									</li>
								</ul>
							</div>
						</div>
						<div class="card chat dlab-chat-history-box d-none">
							<div class="card-header chat-list-header text-center">
								<a href="javascript:void(0);" class="dlab-chat-history-back">
									<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
										width="18px" height="18px" viewBox="0 0 24 24" version="1.1">
										<g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
											<polygon points="0 0 24 0 24 24 0 24" />
											<rect fill="#000000" opacity="0.3"
												transform="translate(15.000000, 12.000000) scale(-1, 1) rotate(-90.000000) translate(-15.000000, -12.000000) "
												x="14" y="7" width="2" height="10" rx="1" />
											<path
												d="M3.7071045,15.7071045 C3.3165802,16.0976288 2.68341522,16.0976288 2.29289093,15.7071045 C1.90236664,15.3165802 1.90236664,14.6834152 2.29289093,14.2928909 L8.29289093,8.29289093 C8.67146987,7.914312 9.28105631,7.90106637 9.67572234,8.26284357 L15.6757223,13.7628436 C16.0828413,14.136036 16.1103443,14.7686034 15.7371519,15.1757223 C15.3639594,15.5828413 14.7313921,15.6103443 14.3242731,15.2371519 L9.03007346,10.3841355 L3.7071045,15.7071045 Z"
												fill="#000000" fill-rule="nonzero"
												transform="translate(9.000001, 11.999997) scale(-1, -1) rotate(90.000000) translate(-9.000001, -11.999997) " />
										</g>
									</svg>
								</a>
								<div>
									<h6 class="mb-1">Chat with Khelesh</h6>
									<p class="mb-0 text-success">Online</p>
								</div>
								<div class="dropdown">
									<a href="javascript:void(0);" data-bs-toggle="dropdown" aria-expanded="false"><svg
											xmlns="http://www.w3.org/2000/svg"
											xmlns:xlink="http://www.w3.org/1999/xlink" width="18px" height="18px"
											viewBox="0 0 24 24" version="1.1">
											<g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
												<rect x="0" y="0" width="24" height="24" />
												<circle fill="#000000" cx="5" cy="12" r="2" />
												<circle fill="#000000" cx="12" cy="12" r="2" />
												<circle fill="#000000" cx="19" cy="12" r="2" />
											</g>
										</svg></a>
									<ul class="dropdown-menu dropdown-menu-end">
										<li class="dropdown-item"><i class="fa fa-user-circle text-primary me-2"></i>
											View profile</li>
										<li class="dropdown-item"><i class="fa fa-users text-primary me-2"></i> Add to
											btn-close friends</li>
										<li class="dropdown-item"><i class="fa fa-plus text-primary me-2"></i> Add to
											group</li>
										<li class="dropdown-item"><i class="fa fa-ban text-primary me-2"></i> Block</li>
									</ul>
								</div>
							</div>
							<div class="card-body msg_card_body dlab-scroll" id="DLAB_W_Contacts_Body3">
								<div class="d-flex justify-content-start mb-4">
									<div class="img_cont_msg">
										<img src="images/avatar/1.jpg" class="rounded-circle user_img_msg" alt="">
									</div>
									<div class="msg_cotainer">
										Hi, how are you samim?
										<span class="msg_time">8:40 AM, Today</span>
									</div>
								</div>
								<div class="d-flex justify-content-end mb-4">
									<div class="msg_cotainer_send">
										Hi Khalid i am good tnx how about you?
										<span class="msg_time_send">8:55 AM, Today</span>
									</div>
									<div class="img_cont_msg">
										<img src="images/avatar/2.jpg" class="rounded-circle user_img_msg" alt="">
									</div>
								</div>
								<div class="d-flex justify-content-start mb-4">
									<div class="img_cont_msg">
										<img src="images/avatar/1.jpg" class="rounded-circle user_img_msg" alt="">
									</div>
									<div class="msg_cotainer">
										I am good too, thank you for your chat template
										<span class="msg_time">9:00 AM, Today</span>
									</div>
								</div>
								<div class="d-flex justify-content-end mb-4">
									<div class="msg_cotainer_send">
										You are welcome
										<span class="msg_time_send">9:05 AM, Today</span>
									</div>
									<div class="img_cont_msg">
										<img src="images/avatar/2.jpg" class="rounded-circle user_img_msg" alt="">
									</div>
								</div>
								<div class="d-flex justify-content-start mb-4">
									<div class="img_cont_msg">
										<img src="images/avatar/1.jpg" class="rounded-circle user_img_msg" alt="">
									</div>
									<div class="msg_cotainer">
										I am looking for your next templates
										<span class="msg_time">9:07 AM, Today</span>
									</div>
								</div>
								<div class="d-flex justify-content-end mb-4">
									<div class="msg_cotainer_send">
										Ok, thank you have a good day
										<span class="msg_time_send">9:10 AM, Today</span>
									</div>
									<div class="img_cont_msg">
										<img src="images/avatar/2.jpg" class="rounded-circle user_img_msg" alt="">
									</div>
								</div>
								<div class="d-flex justify-content-start mb-4">
									<div class="img_cont_msg">
										<img src="images/avatar/1.jpg" class="rounded-circle user_img_msg" alt="">
									</div>
									<div class="msg_cotainer">
										Bye, see you
										<span class="msg_time">9:12 AM, Today</span>
									</div>
								</div>
								<div class="d-flex justify-content-start mb-4">
									<div class="img_cont_msg">
										<img src="images/avatar/1.jpg" class="rounded-circle user_img_msg" alt="">
									</div>
									<div class="msg_cotainer">
										Hi, how are you samim?
										<span class="msg_time">8:40 AM, Today</span>
									</div>
								</div>
								<div class="d-flex justify-content-end mb-4">
									<div class="msg_cotainer_send">
										Hi Khalid i am good tnx how about you?
										<span class="msg_time_send">8:55 AM, Today</span>
									</div>
									<div class="img_cont_msg">
										<img src="images/avatar/2.jpg" class="rounded-circle user_img_msg" alt="">
									</div>
								</div>
								<div class="d-flex justify-content-start mb-4">
									<div class="img_cont_msg">
										<img src="images/avatar/1.jpg" class="rounded-circle user_img_msg" alt="">
									</div>
									<div class="msg_cotainer">
										I am good too, thank you for your chat template
										<span class="msg_time">9:00 AM, Today</span>
									</div>
								</div>
								<div class="d-flex justify-content-end mb-4">
									<div class="msg_cotainer_send">
										You are welcome
										<span class="msg_time_send">9:05 AM, Today</span>
									</div>
									<div class="img_cont_msg">
										<img src="images/avatar/2.jpg" class="rounded-circle user_img_msg" alt="">
									</div>
								</div>
								<div class="d-flex justify-content-start mb-4">
									<div class="img_cont_msg">
										<img src="images/avatar/1.jpg" class="rounded-circle user_img_msg" alt="">
									</div>
									<div class="msg_cotainer">
										I am looking for your next templates
										<span class="msg_time">9:07 AM, Today</span>
									</div>
								</div>
								<div class="d-flex justify-content-end mb-4">
									<div class="msg_cotainer_send">
										Ok, thank you have a good day
										<span class="msg_time_send">9:10 AM, Today</span>
									</div>
									<div class="img_cont_msg">
										<img src="images/avatar/2.jpg" class="rounded-circle user_img_msg" alt="">
									</div>
								</div>
								<div class="d-flex justify-content-start mb-4">
									<div class="img_cont_msg">
										<img src="images/avatar/1.jpg" class="rounded-circle user_img_msg" alt="">
									</div>
									<div class="msg_cotainer">
										Bye, see you
										<span class="msg_time">9:12 AM, Today</span>
									</div>
								</div>
							</div>
							<div class="card-footer type_msg">
								<div class="input-group">
									<textarea class="form-control" placeholder="Type your message..."></textarea>
									<div class="input-group-append">
										<button type="button" class="btn btn-primary"><i
												class="fa fa-location-arrow"></i></button>
									</div>
								</div>
							</div>
						</div>
					</div>
					<div class="tab-pane fade" id="alerts" role="tabpanel">
						<div class="card mb-sm-3 mb-md-0 contacts_card">
							<div class="card-header chat-list-header text-center">
								<a href="javascript:void(0);"><svg xmlns="http://www.w3.org/2000/svg"
										xmlns:xlink="http://www.w3.org/1999/xlink" width="18px" height="18px"
										viewBox="0 0 24 24" version="1.1">
										<g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
											<rect x="0" y="0" width="24" height="24" />
											<circle fill="#000000" cx="5" cy="12" r="2" />
											<circle fill="#000000" cx="12" cy="12" r="2" />
											<circle fill="#000000" cx="19" cy="12" r="2" />
										</g>
									</svg></a>
								<div>
									<h6 class="mb-1">Notications</h6>
									<p class="mb-0">Show All</p>
								</div>
								<a href="javascript:void(0);"><svg xmlns="http://www.w3.org/2000/svg"
										xmlns:xlink="http://www.w3.org/1999/xlink" width="18px" height="18px"
										viewBox="0 0 24 24" version="1.1">
										<g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
											<rect x="0" y="0" width="24" height="24" />
											<path
												d="M14.2928932,16.7071068 C13.9023689,16.3165825 13.9023689,15.6834175 14.2928932,15.2928932 C14.6834175,14.9023689 15.3165825,14.9023689 15.7071068,15.2928932 L19.7071068,19.2928932 C20.0976311,19.6834175 20.0976311,20.3165825 19.7071068,20.7071068 C19.3165825,21.0976311 18.6834175,21.0976311 18.2928932,20.7071068 L14.2928932,16.7071068 Z"
												fill="#000000" fill-rule="nonzero" opacity="0.3" />
											<path
												d="M11,16 C13.7614237,16 16,13.7614237 16,11 C16,8.23857625 13.7614237,6 11,6 C8.23857625,6 6,8.23857625 6,11 C6,13.7614237 8.23857625,16 11,16 Z M11,18 C7.13400675,18 4,14.8659932 4,11 C4,7.13400675 7.13400675,4 11,4 C14.8659932,4 18,7.13400675 18,11 C18,14.8659932 14.8659932,18 11,18 Z"
												fill="#000000" fill-rule="nonzero" />
										</g>
									</svg></a>
							</div>
							<div class="card-body contacts_body p-0 dlab-scroll" id="DLAB_W_Contacts_Body1">
								<ul class="contacts">
									<li class="name-first-letter">SEVER STATUS</li>
									<li class="active">
										<div class="d-flex bd-highlight">
											<div class="img_cont primary">KK</div>
											<div class="user_info">
												<span>David Nester Birthday</span>
												<p class="text-primary">Today</p>
											</div>
										</div>
									</li>
									<li class="name-first-letter">SOCIAL</li>
									<li>
										<div class="d-flex bd-highlight">
											<div class="img_cont success">RU</div>
											<div class="user_info">
												<span>Perfection Simplified</span>
												<p>Jame Smith commented on your status</p>
											</div>
										</div>
									</li>
									<li class="name-first-letter">SEVER STATUS</li>
									<li>
										<div class="d-flex bd-highlight">
											<div class="img_cont primary">AU</div>
											<div class="user_info">
												<span>AharlieKane</span>
												<p>Sami is online</p>
											</div>
										</div>
									</li>
									<li>
										<div class="d-flex bd-highlight">
											<div class="img_cont info">MO</div>
											<div class="user_info">
												<span>Athan Jacoby</span>
												<p>Nargis left 30 mins ago</p>
											</div>
										</div>
									</li>
								</ul>
							</div>
							<div class="card-footer"></div>
						</div>
					</div>
					<div class="tab-pane fade" id="notes">
						<div class="card mb-sm-3 mb-md-0 note_card">
							<div class="card-header chat-list-header text-center">
								<a href="javascript:void(0);"><svg xmlns="http://www.w3.org/2000/svg"
										xmlns:xlink="http://www.w3.org/1999/xlink" width="18px" height="18px"
										viewBox="0 0 24 24" version="1.1">
										<g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
											<rect fill="#000000" x="4" y="11" width="16" height="2" rx="1" />
											<rect fill="#000000" opacity="0.3"
												transform="translate(12.000000, 12.000000) rotate(-270.000000) translate(-12.000000, -12.000000) "
												x="4" y="11" width="16" height="2" rx="1" />
										</g>
									</svg></a>
								<div>
									<h6 class="mb-1">Notes</h6>
									<p class="mb-0">Add New Nots</p>
								</div>
								<a href="javascript:void(0);"><svg xmlns="http://www.w3.org/2000/svg"
										xmlns:xlink="http://www.w3.org/1999/xlink" width="18px" height="18px"
										viewBox="0 0 24 24" version="1.1">
										<g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
											<rect x="0" y="0" width="24" height="24" />
											<path
												d="M14.2928932,16.7071068 C13.9023689,16.3165825 13.9023689,15.6834175 14.2928932,15.2928932 C14.6834175,14.9023689 15.3165825,14.9023689 15.7071068,15.2928932 L19.7071068,19.2928932 C20.0976311,19.6834175 20.0976311,20.3165825 19.7071068,20.7071068 C19.3165825,21.0976311 18.6834175,21.0976311 18.2928932,20.7071068 L14.2928932,16.7071068 Z"
												fill="#000000" fill-rule="nonzero" opacity="0.3" />
											<path
												d="M11,16 C13.7614237,16 16,13.7614237 16,11 C16,8.23857625 13.7614237,6 11,6 C8.23857625,6 6,8.23857625 6,11 C6,13.7614237 8.23857625,16 11,16 Z M11,18 C7.13400675,18 4,14.8659932 4,11 C4,7.13400675 7.13400675,4 11,4 C14.8659932,4 18,7.13400675 18,11 C18,14.8659932 14.8659932,18 11,18 Z"
												fill="#000000" fill-rule="nonzero" />
										</g>
									</svg></a>
							</div>
							<div class="card-body contacts_body p-0 dlab-scroll" id="DLAB_W_Contacts_Body2">
								<ul class="contacts">
									<li class="active">
										<div class="d-flex bd-highlight">
											<div class="user_info">
												<span>New order placed..</span>
												<p>10 Aug 2020</p>
											</div>
											<div class="ms-auto">
												<a href="javascript:void(0);"
													class="btn btn-primary btn-xs sharp me-1"><i
														class="fas fa-pencil-alt"></i></a>
												<a href="javascript:void(0);" class="btn btn-danger btn-xs sharp"><i
														class="fa fa-trash"></i></a>
											</div>
										</div>
									</li>
									<li>
										<div class="d-flex bd-highlight">
											<div class="user_info">
												<span>Youtube, a video-sharing website..</span>
												<p>10 Aug 2020</p>
											</div>
											<div class="ms-auto">
												<a href="javascript:void(0);"
													class="btn btn-primary btn-xs sharp me-1"><i
														class="fas fa-pencil-alt"></i></a>
												<a href="javascript:void(0);" class="btn btn-danger btn-xs sharp"><i
														class="fa fa-trash"></i></a>
											</div>
										</div>
									</li>
									<li>
										<div class="d-flex bd-highlight">
											<div class="user_info">
												<span>john just buy your product..</span>
												<p>10 Aug 2020</p>
											</div>
											<div class="ms-auto">
												<a href="javascript:void(0);"
													class="btn btn-primary btn-xs sharp me-1"><i
														class="fas fa-pencil-alt"></i></a>
												<a href="javascript:void(0);" class="btn btn-danger btn-xs sharp"><i
														class="fa fa-trash"></i></a>
											</div>
										</div>
									</li>
									<li>
										<div class="d-flex bd-highlight">
											<div class="user_info">
												<span>Athan Jacoby</span>
												<p>10 Aug 2020</p>
											</div>
											<div class="ms-auto">
												<a href="javascript:void(0);"
													class="btn btn-primary btn-xs sharp me-1"><i
														class="fas fa-pencil-alt"></i></a>
												<a href="javascript:void(0);" class="btn btn-danger btn-xs sharp"><i
														class="fa fa-trash"></i></a>
											</div>
										</div>
									</li>
								</ul>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<!--**********************************
            Chat box End
        ***********************************-->




		<!--**********************************
            Header start
        ***********************************-->
		<div id="header-navbar" class="header">

		</div>

		<!--**********************************
            Header end ti-comment-alt
        ***********************************-->

		<!--**********************************
            Sidebar start
        ***********************************-->
		<div class="dlabnav">
			<div class="feature-box style-3">
				<div class="wallet-box">
					<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="50px"
						height="50px" viewBox="0 0 24 24" version="1.1" class="svg-main-icon">
						<g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
							<rect x="0" y="0" width="24" height="24" />
							<circle fill="#fff" opacity="0.3" cx="20.5" cy="12.5" r="1.5" />
							<rect fill="#fff" opacity="0.3"
								transform="translate(12.000000, 6.500000) rotate(-15.000000) translate(-12.000000, -6.500000) "
								x="3" y="3" width="18" height="7" rx="1" />
							<path
								d="M22,9.33681558 C21.5453723,9.12084552 21.0367986,9 20.5,9 C18.5670034,9 17,10.5670034 17,12.5 C17,14.4329966 18.5670034,16 20.5,16 C21.0367986,16 21.5453723,15.8791545 22,15.6631844 L22,18 C22,19.1045695 21.1045695,20 20,20 L4,20 C2.8954305,20 2,19.1045695 2,18 L2,6 C2,4.8954305 2.8954305,4 4,4 L20,4 C21.1045695,4 22,4.8954305 22,6 L22,9.33681558 Z"
								fill="#fff" />
						</g>
					</svg>
					<div class="ms-3">
						<h4 class="text-white mb-0">$2353.25</h4>
						<small>Withdraw Money</small>
					</div>
				</div>
			</div>
			<span class="main-menu">Main Menu</span>
			<div id="menu-scroll"></div>
		</div>
		<!--**********************************
            Sidebar end
        ***********************************-->

		<!--**********************************
            Content body start
        ***********************************-->
		<div class="content-body">
			<div class="container-fluid">
				<div class="row">
					<div class="col-lg-12">
						<button class="btn btn-primary" onclick="downloadPDF()">Download PDF</button>

						<div class="card mt-3 receipt-card" id="receipt-card">
							<div class="bg-receipt">
								<img alt="Wedding Background" id="service-bg" class="img-fluid">
							</div>

							<div class="card-header">Receipt <strong id="receipt-date"></strong> <span
									class="float-end">
									Status: <span class="font-w600" id="receipt-status"></strong></span></span>
							</div>
							<div class="card-body">
								<div class="row mb-5">
									<div class="mt-4 col-xl-3 col-lg-4 col-md-6 col-sm-12">
										<h6>From:</h6>
										<div> <strong id="from-company-name"></strong> </div>
										<div id="from-address"></div>
										<div id="from-email"></div>
										<div id="from-phone"></div>
									</div>
									<div class="mt-4 col-xl-3 col-lg-4 col-md-6 col-sm-12">
										<h6>To:</h6>
										<div> <strong id="to-name"></strong> </div>
										<div id="to-state"></div>
										<div id="to-address"></div>
										<div id="to-phone"></div>
									</div>
									<div
										class="mt-4 col-xl-6 col-lg-4 col-md-6 col-sm-12 d-flex justify-content-lg-end justify-content-md-strat justify-content-xs-start">
										<div class="row align-items-center">
											<div class="col-sm-9">
												<div class="brand-logo invoice-logo mb-3">
													<img class="logo-abbr me-2" width="200"
														src="./images/Logo-saya-niaga.png" alt="">
												</div>
											</div>
										</div>
									</div>
								</div>

								<div class="table-responsive">
									<table class="table">
										<thead>
											<tr>
												<th class="center">#</th>
												<th class="left">Date / Time</th>
												<th>Package</th>
												<th>Type</th>
												<!-- <th class="left">Description</th> -->
												<th class="center" id="item-header">Item</th>
												<th class="center">Price</th>

											</tr>
										</thead>
										<tbody id="booking-items" class="table-striped">
											<!-- Dynamic Item Rows will go here -->
										</tbody>
									</table>
								</div>

								<div class="row">
									<div class="col-lg-6 col-sm-6">
										<div class="mt-4 col-xl-6 col-lg-6 col-md-6 col-sm-12">
											<h6>Payment Method:</h6>
											<div> <strong id="payment-method"></strong> </div>
										</div>
									</div>
									<div class="col-lg-4 col-sm-5 ms-auto ps-xl-4 ps-lg-0">
										<table class="table table-clear">
											<tbody id="receipt-totals">
												<!-- Dynamic Total Fields will go here -->
											</tbody>
										</table>
									</div>
								</div>
								<div class="row">
									<div class="col-lg-12 col-sm-12">
										<div class="mt-4 col-xl-12 col-lg-12 col-md-12 col-sm-12">
											<div class="d-flex" style="gap: 20px;">
												<!-- WhatsApp Info -->
												<div class="d-flex align-items-center" id="whatsapp-container">
													<i class="fab fa-whatsapp me-2" id="whatsapp-icon"></i>
													<span id="whatsapp">011-xxxxx</span>
												</div>

												<!-- TikTok Info -->
												<div class="d-flex align-items-center" id="tiktok-container">
													<i class="fab fa-tiktok me-2" id="tiktok-icon"></i>
													<span id="tiktok">@tiktok_name</span>
												</div>

												<!-- Instagram Info -->
												<div class="d-flex align-items-center" id="instagram-container">
													<i class="fab fa-instagram me-2" id="instagram-icon"></i>
													<span id="instagram">@instagram_name</span>
												</div>

												<!-- Facebook Info -->
												<div class="d-flex align-items-center" id="facebook-container">
													<i class="fab fa-facebook me-2" id="facebook-icon"></i>
													<span id="facebook">facebook_name</span>
												</div>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>

				</div>
			</div>
		</div>
	</div>
	<!--**********************************
            Content body end
        ***********************************-->


	<!--**********************************
            Footer start
        ***********************************-->
	<div class="footer">
		<div class="copyright">
			<p>Copyright © Designed &amp; Developed by <a href="https://dexignlab.com/" target="_blank">DexignLab</a>
				<span class="current-year">2024</span>
			</p>
		</div>
	</div>
	<!--**********************************
            Footer end
        ***********************************-->

	<!--**********************************
           Support ticket button start
        ***********************************-->

	<!--**********************************
           Support ticket button end
        ***********************************-->


	</div>
	<!--**********************************
        Main wrapper end
    ***********************************-->

	<!--**********************************
        Scripts
    ***********************************-->
	<!-- Required vendors -->
	<script src="vendor/global/global.min.js"></script>
	<script src="vendor/bootstrap-select/dist/js/bootstrap-select.min.js"></script>
	<script src="js/custom.min.js"></script>
	<script src="js/dlabnav-init.js"></script>

	<script>
		window.onload = () => {
			const { jsPDF } = window.jspdf;

			window.downloadPDF = () => {
				const original = document.getElementById("receipt-card");


				// Clone and style for A4
				const clone = original.cloneNode(true);
				const bgReceipt = clone.querySelector('.bg-receipt');
				if (bgReceipt) {
					bgReceipt.style.display = 'none'; // Hide bg-receipt for the PDF
				}
				clone.style.width = "794px"; // 210mm in pixels at 96dpi ≈ 794px
				clone.style.padding = "40px";
				clone.style.background = "white";
				clone.style.position = "absolute";
				clone.style.left = "-9999px"; // hide off screen

				document.body.appendChild(clone);

				html2canvas(clone, {
					scale: 2,
					useCORS: true
				}).then((canvas) => {
					const imgData = canvas.toDataURL("image/png");
					const pdf = new jsPDF("p", "mm", "a4");

					const pageWidth = pdf.internal.pageSize.getWidth();
					const pageHeight = pdf.internal.pageSize.getHeight();

					const imgProps = pdf.getImageProperties(imgData);
					const ratio = imgProps.width / imgProps.height;

					const pdfWidth = pageWidth;
					const pdfHeight = pdfWidth / ratio;

					let heightLeft = pdfHeight;
					let position = 0;

					pdf.addImage(imgData, "PNG", 0, position, pdfWidth, pdfHeight);
					heightLeft -= pageHeight;

					while (heightLeft > 0) {
						position = heightLeft - pdfHeight;
						pdf.addPage();
						pdf.addImage(imgData, "PNG", 0, position, pdfWidth, pdfHeight);
						heightLeft -= pageHeight;
					}

					pdf.save("receipt.pdf");
					document.body.removeChild(clone); // cleanup
				});
			};

		};
	</script>


</body>

</html>